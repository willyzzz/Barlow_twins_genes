2024-09-16 17:40:59,900 - INFO - Using device: cuda
2024-09-16 17:40:59,900 - INFO - Stage 1: Loading data...
2024-09-16 17:41:30,827 - INFO - Number of classes: 5
2024-09-16 17:41:30,827 - INFO - Stage 2: Initializing models...
2024-09-16 17:41:30,939 - INFO - Stage 3: Training Barlow Twins...
2024-09-16 17:41:47,203 - INFO - Stage 4: Preparing data for classification...
2024-09-16 17:41:47,223 - INFO - Stage 5: Generating Barlow Twins embeddings...
2024-09-16 17:41:47,227 - INFO - Embeddings saved to embedding/embedding_20240916_174059.pt
2024-09-16 17:41:47,227 - INFO - Stage 6: Preparing MLP classifier...
2024-09-16 17:41:47,441 - INFO - Stage 7: Training and evaluating MLP on original bulk data...
2024-09-16 17:41:47,442 - INFO - Training MLP on original bulk data (using SMOTE)...
2024-09-16 17:42:07,245 - INFO - Epoch [100/100], Average Loss: 0.9054
2024-09-16 17:42:07,252 - INFO - Evaluating MLP on original bulk data:
2024-09-16 17:42:07,254 - INFO - 
Sample counts for each class:
2024-09-16 17:42:07,254 - INFO - Stage 1: 23 samples
2024-09-16 17:42:07,254 - INFO - Stage 2: 100 samples
2024-09-16 17:42:07,254 - INFO - Stage 3: 31 samples
2024-09-16 17:42:07,254 - INFO - Stage 4: 3 samples
2024-09-16 17:42:07,254 - INFO - Stage 5: 4 samples
2024-09-16 17:42:07,254 - INFO - Total samples: 161
2024-09-16 17:42:07,256 - INFO - 
F1 scores for each class:
2024-09-16 17:42:07,256 - INFO - Stage 1 F1 score: 0.0588
2024-09-16 17:42:07,256 - INFO - Stage 2 F1 score: 0.6972
2024-09-16 17:42:07,256 - INFO - Stage 3 F1 score: 0.2903
2024-09-16 17:42:07,257 - INFO - Stage 4 F1 score: 0.0000
2024-09-16 17:42:07,257 - INFO - Stage 5 F1 score: 0.0000
2024-09-16 17:42:07,258 - INFO - 
Macro-averaged F1 score: 0.2093
2024-09-16 17:42:07,263 - INFO - Average precision score: 0.2382
2024-09-16 17:42:07,264 - INFO - 
Confusion Matrix:
2024-09-16 17:42:07,265 - INFO - 
[[ 1 17  5  0  0]
 [ 8 76 15  0  1]
 [ 2 20  9  0  0]
 [ 0  2  1  0  0]
 [ 0  3  1  0  0]]
2024-09-16 17:42:07,271 - INFO - 
Classification Report:
2024-09-16 17:42:07,271 - INFO - 
              precision    recall  f1-score   support

           1       0.09      0.04      0.06        23
           2       0.64      0.76      0.70       100
           3       0.29      0.29      0.29        31
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         4

    accuracy                           0.53       161
   macro avg       0.21      0.22      0.21       161
weighted avg       0.47      0.53      0.50       161

2024-09-16 17:42:07,271 - INFO - Stage 8: Training and evaluating MLP on Barlow Twins embeddings...
2024-09-16 17:42:24,901 - INFO - Epoch [100/100], Average Loss: 1.1560
2024-09-16 17:42:24,902 - INFO - Evaluating MLP on Barlow Twins embeddings:
2024-09-16 17:42:24,903 - INFO - 
Sample counts for each class:
2024-09-16 17:42:24,903 - INFO - Stage 1: 23 samples
2024-09-16 17:42:24,903 - INFO - Stage 2: 100 samples
2024-09-16 17:42:24,903 - INFO - Stage 3: 31 samples
2024-09-16 17:42:24,903 - INFO - Stage 4: 3 samples
2024-09-16 17:42:24,903 - INFO - Stage 5: 4 samples
2024-09-16 17:42:24,904 - INFO - Total samples: 161
2024-09-16 17:42:24,905 - INFO - 
F1 scores for each class:
2024-09-16 17:42:24,906 - INFO - Stage 1 F1 score: 0.2667
2024-09-16 17:42:24,906 - INFO - Stage 2 F1 score: 0.4354
2024-09-16 17:42:24,906 - INFO - Stage 3 F1 score: 0.2169
2024-09-16 17:42:24,906 - INFO - Stage 4 F1 score: 0.0000
2024-09-16 17:42:24,906 - INFO - Stage 5 F1 score: 0.0000
2024-09-16 17:42:24,908 - INFO - 
Macro-averaged F1 score: 0.1838
2024-09-16 17:42:24,913 - INFO - Average precision score: 0.2279
2024-09-16 17:42:24,914 - INFO - 
Confusion Matrix:
2024-09-16 17:42:24,914 - INFO - 
[[10  4  8  0  1]
 [27 32 33  5  3]
 [12  9  9  0  1]
 [ 2  0  1  0  0]
 [ 1  2  1  0  0]]
2024-09-16 17:42:24,920 - INFO - 
Classification Report:
2024-09-16 17:42:24,920 - INFO - 
              precision    recall  f1-score   support

           1       0.19      0.43      0.27        23
           2       0.68      0.32      0.44       100
           3       0.17      0.29      0.22        31
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         4

    accuracy                           0.32       161
   macro avg       0.21      0.21      0.18       161
weighted avg       0.48      0.32      0.35       161

2024-09-16 17:42:24,920 - INFO - All stages completed.
