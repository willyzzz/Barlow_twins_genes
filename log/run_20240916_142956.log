2024-09-16 14:29:56,773 - INFO - Using device: cuda
2024-09-16 14:29:56,774 - INFO - Stage 1: Loading data...
2024-09-16 14:30:27,726 - INFO - Stage 2: Initializing models...
2024-09-16 14:30:27,840 - INFO - Stage 3: Training Barlow Twins...
2024-09-16 14:30:36,796 - INFO - Stage 4: Preparing data for classification...
2024-09-16 14:30:36,815 - INFO - Stage 5: Generating Barlow Twins embeddings...
2024-09-16 14:30:36,819 - INFO - Embeddings saved to embedding/embedding_20240916_142956.pt
2024-09-16 14:30:36,819 - INFO - Stage 6: Preparing MLP classifier...
2024-09-16 14:30:37,038 - INFO - Stage 7: Training and evaluating MLP on original bulk data...
2024-09-16 14:30:37,044 - INFO - Training MLP on original bulk data (using SMOTE)...
2024-09-16 14:30:56,521 - INFO - Epoch [100/100], Average Loss: 0.9149
2024-09-16 14:30:56,527 - INFO - Evaluating MLP on original bulk data:
2024-09-16 14:30:56,529 - INFO - 
Sample counts for each class:
2024-09-16 14:30:56,529 - INFO - Stage 1: 23 samples
2024-09-16 14:30:56,529 - INFO - Stage 2: 100 samples
2024-09-16 14:30:56,529 - INFO - Stage 3: 31 samples
2024-09-16 14:30:56,530 - INFO - Stage 4: 3 samples
2024-09-16 14:30:56,530 - INFO - Stage 5: 4 samples
2024-09-16 14:30:56,530 - INFO - Total samples: 161
2024-09-16 14:30:56,531 - INFO - 
F1 scores for each class:
2024-09-16 14:30:56,532 - INFO - Stage 1 F1 score: 0.2000
2024-09-16 14:30:56,532 - INFO - Stage 2 F1 score: 0.6731
2024-09-16 14:30:56,532 - INFO - Stage 3 F1 score: 0.3750
2024-09-16 14:30:56,532 - INFO - Stage 4 F1 score: 0.0000
2024-09-16 14:30:56,532 - INFO - Stage 5 F1 score: 0.0000
2024-09-16 14:30:56,533 - INFO - 
Macro-averaged F1 score: 0.2496
2024-09-16 14:30:56,543 - INFO - Average precision score: 0.2640
2024-09-16 14:30:56,543 - INFO - 
Confusion Matrix:
2024-09-16 14:30:56,544 - INFO - 
[[ 4 15  4  0  0]
 [10 70 17  1  2]
 [ 3 16 12  0  0]
 [ 0  3  0  0  0]
 [ 0  4  0  0  0]]
2024-09-16 14:30:56,548 - INFO - 
Classification Report:
2024-09-16 14:30:56,548 - INFO - 
              precision    recall  f1-score   support

           1       0.24      0.17      0.20        23
           2       0.65      0.70      0.67       100
           3       0.36      0.39      0.38        31
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         4

    accuracy                           0.53       161
   macro avg       0.25      0.25      0.25       161
weighted avg       0.51      0.53      0.52       161

2024-09-16 14:30:56,548 - INFO - Stage 8: Training and evaluating MLP on Barlow Twins embeddings...
2024-09-16 14:30:56,549 - INFO - Training MLP on Barlow Twins embeddings (using SMOTE)...
2024-09-16 14:31:14,539 - INFO - Epoch [100/100], Average Loss: 0.9644
2024-09-16 14:31:14,539 - INFO - Evaluating MLP on Barlow Twins embeddings:
2024-09-16 14:31:14,540 - INFO - 
Sample counts for each class:
2024-09-16 14:31:14,541 - INFO - Stage 1: 23 samples
2024-09-16 14:31:14,541 - INFO - Stage 2: 100 samples
2024-09-16 14:31:14,541 - INFO - Stage 3: 31 samples
2024-09-16 14:31:14,541 - INFO - Stage 4: 3 samples
2024-09-16 14:31:14,541 - INFO - Stage 5: 4 samples
2024-09-16 14:31:14,541 - INFO - Total samples: 161
2024-09-16 14:31:14,543 - INFO - 
F1 scores for each class:
2024-09-16 14:31:14,543 - INFO - Stage 1 F1 score: 0.2373
2024-09-16 14:31:14,543 - INFO - Stage 2 F1 score: 0.5424
2024-09-16 14:31:14,544 - INFO - Stage 3 F1 score: 0.2973
2024-09-16 14:31:14,544 - INFO - Stage 4 F1 score: 0.0000
2024-09-16 14:31:14,544 - INFO - Stage 5 F1 score: 0.0000
2024-09-16 14:31:14,546 - INFO - 
Macro-averaged F1 score: 0.2154
2024-09-16 14:31:14,550 - INFO - Average precision score: 0.2328
2024-09-16 14:31:14,552 - INFO - 
Confusion Matrix:
2024-09-16 14:31:14,552 - INFO - 
[[ 7 13  3  0  0]
 [23 48 27  1  1]
 [ 3 15 11  1  1]
 [ 1  0  2  0  0]
 [ 2  1  0  1  0]]
2024-09-16 14:31:14,558 - INFO - 
Classification Report:
2024-09-16 14:31:14,558 - INFO - 
              precision    recall  f1-score   support

           1       0.19      0.30      0.24        23
           2       0.62      0.48      0.54       100
           3       0.26      0.35      0.30        31
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         4

    accuracy                           0.41       161
   macro avg       0.21      0.23      0.22       161
weighted avg       0.46      0.41      0.43       161

2024-09-16 14:31:14,558 - INFO - All stages completed.
