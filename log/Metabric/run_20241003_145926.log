2024-10-03 14:59:26,524 - INFO - Using device: cuda
2024-10-03 14:59:26,524 - INFO - Stage 1: Loading data...
2024-10-03 15:02:01,561 - INFO - Number of classes: 5
2024-10-03 15:02:01,561 - INFO - Stage 2: Initializing models...
2024-10-03 15:02:01,749 - INFO - Configuration Parameters:
2024-10-03 15:02:01,749 - INFO - seed: 42
2024-10-03 15:02:01,749 - INFO - batchsize: 128
2024-10-03 15:02:01,749 - INFO - sample_size: 1000
2024-10-03 15:02:01,749 - INFO - lambda_noise: 0.1
2024-10-03 15:02:01,749 - INFO - variance_threshold: 0.95
2024-10-03 15:02:01,749 - INFO - output_dim: 64
2024-10-03 15:02:01,749 - INFO - hidden_dim: 256
2024-10-03 15:02:01,749 - INFO - project_dim: 256
2024-10-03 15:02:01,749 - INFO - mlp_hidden_dim: 64
2024-10-03 15:02:01,749 - INFO - learning_rate: 0.0001
2024-10-03 15:02:01,749 - INFO - weight_decay: 0.001
2024-10-03 15:02:01,749 - INFO - num_epochs: 5000
2024-10-03 15:02:01,749 - INFO - mlp_epochs: 5000
2024-10-03 15:02:01,749 - INFO - loss_lambda_param: 0.005
2024-10-03 15:02:01,749 - INFO - scaling_method: minmax
2024-10-03 15:02:01,749 - INFO - eval_metric: survival
2024-10-03 15:02:01,749 - INFO - model_save_path: ./model_checkpoints
2024-10-03 15:02:01,749 - INFO - fra_save_path: ./fra_pre
2024-10-03 15:02:01,749 - INFO - training_dataset_name: All
2024-10-03 15:02:01,749 - INFO - testing_dataset_name: Metabric
2024-10-03 15:02:01,749 - INFO - device: cuda
2024-10-03 15:02:01,749 - INFO - sc_path: ./cancer_single_cell_data/processed_data.h5ad
2024-10-03 15:02:01,749 - INFO - bulk_path: ./cancer_brca_metabric_bulk_data/data_mrna_illumina_microarray_zscores_ref_diploid_samples.txt
2024-10-03 15:02:01,749 - INFO - stage_path: ./cancer_brca_metabric_bulk_data/Tumor_Stage.txt
2024-10-03 15:02:01,749 - INFO - survival_path: ./Synapse_metabric/Clinical_Overall_Survival_Data_from_METABRIC.txt
2024-10-03 15:02:01,749 - INFO - Model Architectures:
2024-10-03 15:02:01,750 - INFO - Encoder: Encoder(
  (layers): Sequential(
    (0): Linear(in_features=16195, out_features=2048, bias=True)
    (1): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=2048, out_features=1024, bias=True)
    (5): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Dropout(p=0.2, inplace=False)
    (8): Linear(in_features=1024, out_features=512, bias=True)
    (9): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU()
    (11): Dropout(p=0.2, inplace=False)
    (12): Linear(in_features=512, out_features=256, bias=True)
    (13): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU()
    (15): Dropout(p=0.2, inplace=False)
    (16): Linear(in_features=256, out_features=64, bias=True)
  )
)
2024-10-03 15:02:01,750 - INFO - Projector: Projector(
  (layers): Sequential(
    (0): Linear(in_features=64, out_features=256, bias=False)
    (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Linear(in_features=256, out_features=256, bias=False)
    (4): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Linear(in_features=256, out_features=256, bias=False)
    (7): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
  )
)
2024-10-03 15:02:01,750 - INFO - MLP Bulk: MLPClassifier(
  (layers): Sequential(
    (0): Linear(in_features=16195, out_features=64, bias=True)
    (1): ReLU()
    (2): Linear(in_features=64, out_features=64, bias=True)
    (3): ReLU()
    (4): Linear(in_features=64, out_features=5, bias=True)
  )
)
2024-10-03 15:02:01,750 - INFO - MLP Embedded: MLPClassifier(
  (layers): Sequential(
    (0): Linear(in_features=64, out_features=64, bias=True)
    (1): ReLU()
    (2): Linear(in_features=64, out_features=64, bias=True)
    (3): ReLU()
    (4): Linear(in_features=64, out_features=5, bias=True)
  )
)
2024-10-03 15:02:01,750 - INFO - Stage 3: Training Barlow Twins...
2024-10-03 15:03:30,791 - INFO - Epoch 100 completed. Loss: 8.4721
2024-10-03 15:04:59,437 - INFO - Epoch 200 completed. Loss: 6.6054
2024-10-03 15:06:28,270 - INFO - Epoch 300 completed. Loss: 5.6008
2024-10-03 15:07:57,309 - INFO - Epoch 400 completed. Loss: 5.1296
2024-10-03 15:09:26,655 - INFO - Epoch 500 completed. Loss: 4.9134
2024-10-03 15:10:56,182 - INFO - Epoch 600 completed. Loss: 4.5667
2024-10-03 15:12:25,415 - INFO - Epoch 700 completed. Loss: 4.3314
2024-10-03 15:13:54,607 - INFO - Epoch 800 completed. Loss: 4.2471
2024-10-03 15:15:23,816 - INFO - Epoch 900 completed. Loss: 4.1466
2024-10-03 15:16:52,410 - INFO - Epoch 1000 completed. Loss: 3.9979
2024-10-03 15:18:21,542 - INFO - Epoch 1100 completed. Loss: 3.9305
2024-10-03 15:19:50,471 - INFO - Epoch 1200 completed. Loss: 3.9001
2024-10-03 15:21:19,559 - INFO - Epoch 1300 completed. Loss: 3.8732
2024-10-03 15:22:48,411 - INFO - Epoch 1400 completed. Loss: 3.5846
2024-10-03 15:24:17,458 - INFO - Epoch 1500 completed. Loss: 3.7104
2024-10-03 15:25:46,074 - INFO - Epoch 1600 completed. Loss: 3.6778
2024-10-03 15:27:14,705 - INFO - Epoch 1700 completed. Loss: 3.6058
2024-10-03 15:28:44,066 - INFO - Epoch 1800 completed. Loss: 3.5614
2024-10-03 15:30:13,056 - INFO - Epoch 1900 completed. Loss: 3.4419
2024-10-03 15:31:42,446 - INFO - Epoch 2000 completed. Loss: 3.4722
2024-10-03 15:33:11,643 - INFO - Epoch 2100 completed. Loss: 3.4867
2024-10-03 15:34:40,713 - INFO - Epoch 2200 completed. Loss: 3.3228
2024-10-03 15:36:09,674 - INFO - Epoch 2300 completed. Loss: 3.3659
2024-10-03 15:37:38,937 - INFO - Epoch 2400 completed. Loss: 3.3211
2024-10-03 15:39:08,019 - INFO - Epoch 2500 completed. Loss: 3.2421
2024-10-03 15:40:36,827 - INFO - Epoch 2600 completed. Loss: 3.2034
2024-10-03 15:42:05,917 - INFO - Epoch 2700 completed. Loss: 3.3090
2024-10-03 15:43:34,825 - INFO - Epoch 2800 completed. Loss: 3.2582
2024-10-03 15:45:03,985 - INFO - Epoch 2900 completed. Loss: 3.3038
2024-10-03 15:46:32,975 - INFO - Epoch 3000 completed. Loss: 3.2258
2024-10-03 15:48:01,784 - INFO - Epoch 3100 completed. Loss: 3.1354
2024-10-03 15:49:30,932 - INFO - Epoch 3200 completed. Loss: 3.1512
2024-10-03 15:50:59,820 - INFO - Epoch 3300 completed. Loss: 3.0331
2024-10-03 15:52:28,916 - INFO - Epoch 3400 completed. Loss: 3.1051
2024-10-03 15:53:57,994 - INFO - Epoch 3500 completed. Loss: 3.0652
2024-10-03 15:55:26,936 - INFO - Epoch 3600 completed. Loss: 2.9760
2024-10-03 15:56:55,699 - INFO - Epoch 3700 completed. Loss: 3.0877
2024-10-03 15:58:24,511 - INFO - Epoch 3800 completed. Loss: 2.9254
2024-10-03 15:59:53,851 - INFO - Epoch 3900 completed. Loss: 2.9955
2024-10-03 16:01:23,191 - INFO - Epoch 4000 completed. Loss: 2.9547
2024-10-03 16:02:52,152 - INFO - Epoch 4100 completed. Loss: 2.9930
2024-10-03 16:04:21,378 - INFO - Epoch 4200 completed. Loss: 2.9451
2024-10-03 16:05:50,596 - INFO - Epoch 4300 completed. Loss: 3.0291
2024-10-03 16:07:19,765 - INFO - Epoch 4400 completed. Loss: 2.8280
2024-10-03 16:08:48,792 - INFO - Epoch 4500 completed. Loss: 2.9089
2024-10-03 16:10:17,803 - INFO - Epoch 4600 completed. Loss: 2.8636
2024-10-03 16:11:46,443 - INFO - Epoch 4700 completed. Loss: 2.8160
2024-10-03 16:13:15,017 - INFO - Epoch 4800 completed. Loss: 2.7987
2024-10-03 16:14:44,001 - INFO - Epoch 4900 completed. Loss: 2.8602
2024-10-03 16:16:13,106 - INFO - Epoch 5000 completed. Loss: 2.8076
2024-10-03 16:16:16,723 - INFO - Stage 4: Preparing data for classification...
2024-10-03 16:16:16,764 - INFO - Stage 5: Generating Barlow Twins embeddings...
2024-10-03 16:16:17,812 - INFO - Bulk tensor saved to result/Metabric_20241003_145926/bulk_tensor.pt
2024-10-03 16:16:17,812 - INFO - Embeddings saved to result/Metabric_20241003_145926/embedding.pt
2024-10-03 16:16:17,812 - INFO - All stages completed.
