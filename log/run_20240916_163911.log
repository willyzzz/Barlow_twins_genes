2024-09-16 16:39:11,899 - INFO - Using device: cuda
2024-09-16 16:39:11,899 - INFO - Stage 1: Loading data...
2024-09-16 16:39:42,791 - INFO - Stage 2: Initializing models...
2024-09-16 16:39:42,905 - INFO - Stage 3: Training Barlow Twins...
2024-09-16 16:41:52,362 - INFO - Epoch 100 completed. Loss: 255.8383
2024-09-16 16:44:01,414 - INFO - Epoch 200 completed. Loss: 244.4969
2024-09-16 16:46:09,846 - INFO - Epoch 300 completed. Loss: 256.0465
2024-09-16 16:48:18,742 - INFO - Epoch 400 completed. Loss: 253.1509
2024-09-16 16:50:27,190 - INFO - Epoch 500 completed. Loss: 255.4522
2024-09-16 16:52:35,210 - INFO - Epoch 600 completed. Loss: 257.1744
2024-09-16 16:54:45,181 - INFO - Epoch 700 completed. Loss: 254.1284
2024-09-16 16:56:53,805 - INFO - Epoch 800 completed. Loss: 246.8574
2024-09-16 16:59:01,809 - INFO - Epoch 900 completed. Loss: 254.2500
2024-09-16 17:01:10,987 - INFO - Epoch 1000 completed. Loss: 239.5239
2024-09-16 17:01:32,084 - INFO - Stage 4: Preparing data for classification...
2024-09-16 17:01:32,112 - INFO - Stage 5: Generating Barlow Twins embeddings...
2024-09-16 17:01:32,115 - INFO - Embeddings saved to embedding/embedding_20240916_163911.pt
2024-09-16 17:01:32,116 - INFO - Stage 6: Preparing MLP classifier...
2024-09-16 17:01:32,334 - INFO - Stage 7: Training and evaluating MLP on original bulk data...
2024-09-16 17:01:32,340 - INFO - Training MLP on original bulk data (using SMOTE)...
2024-09-16 17:01:52,294 - INFO - Epoch [100/100], Average Loss: 0.9217
2024-09-16 17:01:52,303 - INFO - Evaluating MLP on original bulk data:
2024-09-16 17:01:52,305 - INFO - 
Sample counts for each class:
2024-09-16 17:01:52,305 - INFO - Stage 1: 23 samples
2024-09-16 17:01:52,305 - INFO - Stage 2: 100 samples
2024-09-16 17:01:52,305 - INFO - Stage 3: 31 samples
2024-09-16 17:01:52,306 - INFO - Stage 4: 3 samples
2024-09-16 17:01:52,306 - INFO - Stage 5: 4 samples
2024-09-16 17:01:52,306 - INFO - Total samples: 161
2024-09-16 17:01:52,307 - INFO - 
F1 scores for each class:
2024-09-16 17:01:52,308 - INFO - Stage 1 F1 score: 0.1778
2024-09-16 17:01:52,308 - INFO - Stage 2 F1 score: 0.6439
2024-09-16 17:01:52,308 - INFO - Stage 3 F1 score: 0.2540
2024-09-16 17:01:52,308 - INFO - Stage 4 F1 score: 0.0000
2024-09-16 17:01:52,308 - INFO - Stage 5 F1 score: 0.0000
2024-09-16 17:01:52,310 - INFO - 
Macro-averaged F1 score: 0.2151
2024-09-16 17:01:52,314 - INFO - Average precision score: 0.2166
2024-09-16 17:01:52,315 - INFO - 
Confusion Matrix:
2024-09-16 17:01:52,315 - INFO - 
[[ 4 13  6  0  0]
 [16 66 17  1  0]
 [ 2 20  8  1  0]
 [ 0  3  0  0  0]
 [ 0  3  1  0  0]]
2024-09-16 17:01:52,321 - INFO - 
Classification Report:
2024-09-16 17:01:52,322 - INFO - 
              precision    recall  f1-score   support

           1       0.18      0.17      0.18        23
           2       0.63      0.66      0.64       100
           3       0.25      0.26      0.25        31
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         4

    accuracy                           0.48       161
   macro avg       0.21      0.22      0.22       161
weighted avg       0.46      0.48      0.47       161

2024-09-16 17:01:52,322 - INFO - Stage 8: Training and evaluating MLP on Barlow Twins embeddings...
2024-09-16 17:01:52,323 - INFO - Training MLP on Barlow Twins embeddings (using SMOTE)...
2024-09-16 17:02:10,257 - INFO - Epoch [100/100], Average Loss: 1.0491
2024-09-16 17:02:10,258 - INFO - Evaluating MLP on Barlow Twins embeddings:
2024-09-16 17:02:10,259 - INFO - 
Sample counts for each class:
2024-09-16 17:02:10,259 - INFO - Stage 1: 23 samples
2024-09-16 17:02:10,260 - INFO - Stage 2: 100 samples
2024-09-16 17:02:10,260 - INFO - Stage 3: 31 samples
2024-09-16 17:02:10,260 - INFO - Stage 4: 3 samples
2024-09-16 17:02:10,260 - INFO - Stage 5: 4 samples
2024-09-16 17:02:10,260 - INFO - Total samples: 161
2024-09-16 17:02:10,262 - INFO - 
F1 scores for each class:
2024-09-16 17:02:10,262 - INFO - Stage 1 F1 score: 0.1875
2024-09-16 17:02:10,262 - INFO - Stage 2 F1 score: 0.3704
2024-09-16 17:02:10,262 - INFO - Stage 3 F1 score: 0.3168
2024-09-16 17:02:10,262 - INFO - Stage 4 F1 score: 0.0000
2024-09-16 17:02:10,262 - INFO - Stage 5 F1 score: 0.0000
2024-09-16 17:02:10,264 - INFO - 
Macro-averaged F1 score: 0.1749
2024-09-16 17:02:10,269 - INFO - Average precision score: 0.2450
2024-09-16 17:02:10,270 - INFO - 
Confusion Matrix:
2024-09-16 17:02:10,270 - INFO - 
[[ 6  3 13  1  0]
 [24 25 39  7  5]
 [ 8  5 16  2  0]
 [ 1  0  2  0  0]
 [ 2  2  0  0  0]]
2024-09-16 17:02:10,276 - INFO - 
Classification Report:
2024-09-16 17:02:10,276 - INFO - 
              precision    recall  f1-score   support

           1       0.15      0.26      0.19        23
           2       0.71      0.25      0.37       100
           3       0.23      0.52      0.32        31
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         4

    accuracy                           0.29       161
   macro avg       0.22      0.21      0.17       161
weighted avg       0.51      0.29      0.32       161

2024-09-16 17:02:10,276 - INFO - All stages completed.
