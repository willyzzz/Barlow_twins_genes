2024-09-16 14:33:10,457 - INFO - Using device: cuda
2024-09-16 14:33:10,457 - INFO - Stage 1: Loading data...
2024-09-16 14:33:41,469 - INFO - Stage 2: Initializing models...
2024-09-16 14:33:41,584 - INFO - Stage 3: Training Barlow Twins...
2024-09-16 14:35:50,187 - INFO - Epoch 100 completed. Loss: 76.5511
2024-09-16 14:37:58,298 - INFO - Epoch 200 completed. Loss: 88.1349
2024-09-16 14:40:06,298 - INFO - Epoch 300 completed. Loss: 87.0280
2024-09-16 14:42:15,424 - INFO - Epoch 400 completed. Loss: 80.4303
2024-09-16 14:44:25,100 - INFO - Epoch 500 completed. Loss: 89.2046
2024-09-16 14:46:32,605 - INFO - Epoch 600 completed. Loss: 86.5676
2024-09-16 14:48:41,257 - INFO - Epoch 700 completed. Loss: 88.4104
2024-09-16 14:50:49,367 - INFO - Epoch 800 completed. Loss: 76.2415
2024-09-16 14:52:58,782 - INFO - Epoch 900 completed. Loss: 82.1307
2024-09-16 14:55:07,968 - INFO - Epoch 1000 completed. Loss: 85.7652
2024-09-16 14:57:16,668 - INFO - Epoch 1100 completed. Loss: 66.2410
2024-09-16 14:59:24,191 - INFO - Epoch 1200 completed. Loss: 84.4382
2024-09-16 15:01:31,337 - INFO - Epoch 1300 completed. Loss: 83.9518
2024-09-16 15:03:39,338 - INFO - Epoch 1400 completed. Loss: 84.6471
2024-09-16 15:05:48,773 - INFO - Epoch 1500 completed. Loss: 60.6260
2024-09-16 15:07:57,768 - INFO - Epoch 1600 completed. Loss: 88.8247
2024-09-16 15:10:06,367 - INFO - Epoch 1700 completed. Loss: 73.5426
2024-09-16 15:12:16,715 - INFO - Epoch 1800 completed. Loss: 56.9809
2024-09-16 15:14:24,437 - INFO - Epoch 1900 completed. Loss: 80.7181
2024-09-16 15:16:33,904 - INFO - Epoch 2000 completed. Loss: 85.3471
2024-09-16 15:18:43,496 - INFO - Epoch 2100 completed. Loss: 83.9973
2024-09-16 15:20:51,008 - INFO - Epoch 2200 completed. Loss: 84.7302
2024-09-16 15:22:59,199 - INFO - Epoch 2300 completed. Loss: 86.6788
2024-09-16 15:25:06,637 - INFO - Epoch 2400 completed. Loss: 85.2393
2024-09-16 15:27:14,723 - INFO - Epoch 2500 completed. Loss: 83.0661
2024-09-16 15:29:23,418 - INFO - Epoch 2600 completed. Loss: 77.6023
2024-09-16 15:31:32,523 - INFO - Epoch 2700 completed. Loss: 82.5849
2024-09-16 15:33:41,139 - INFO - Epoch 2800 completed. Loss: 58.1850
2024-09-16 15:35:48,564 - INFO - Epoch 2900 completed. Loss: 84.4232
2024-09-16 15:37:56,789 - INFO - Epoch 3000 completed. Loss: 52.4154
2024-09-16 15:40:05,750 - INFO - Epoch 3100 completed. Loss: 80.7411
2024-09-16 15:42:13,354 - INFO - Epoch 3200 completed. Loss: 78.2410
2024-09-16 15:44:22,150 - INFO - Epoch 3300 completed. Loss: 85.2928
2024-09-16 15:46:30,265 - INFO - Epoch 3400 completed. Loss: 73.8262
2024-09-16 15:48:37,265 - INFO - Epoch 3500 completed. Loss: 69.1308
2024-09-16 15:50:44,766 - INFO - Epoch 3600 completed. Loss: 82.0997
2024-09-16 15:52:53,758 - INFO - Epoch 3700 completed. Loss: 60.9794
2024-09-16 15:55:03,979 - INFO - Epoch 3800 completed. Loss: 87.9046
2024-09-16 15:57:11,870 - INFO - Epoch 3900 completed. Loss: 76.7718
2024-09-16 15:59:20,284 - INFO - Epoch 4000 completed. Loss: 52.0865
2024-09-16 16:01:28,896 - INFO - Epoch 4100 completed. Loss: 52.6691
2024-09-16 16:03:35,671 - INFO - Epoch 4200 completed. Loss: 86.2930
2024-09-16 16:05:43,868 - INFO - Epoch 4300 completed. Loss: 83.6558
2024-09-16 16:07:51,779 - INFO - Epoch 4400 completed. Loss: 86.1769
2024-09-16 16:10:01,569 - INFO - Epoch 4500 completed. Loss: 83.6857
2024-09-16 16:12:10,394 - INFO - Epoch 4600 completed. Loss: 64.3666
2024-09-16 16:14:19,555 - INFO - Epoch 4700 completed. Loss: 82.8984
2024-09-16 16:16:27,930 - INFO - Epoch 4800 completed. Loss: 77.7813
2024-09-16 16:18:35,076 - INFO - Epoch 4900 completed. Loss: 53.1739
2024-09-16 16:20:42,415 - INFO - Epoch 5000 completed. Loss: 83.6531
2024-09-16 16:20:45,911 - INFO - Stage 4: Preparing data for classification...
2024-09-16 16:20:45,931 - INFO - Stage 5: Generating Barlow Twins embeddings...
2024-09-16 16:20:45,935 - INFO - Embeddings saved to embedding/embedding_20240916_143310.pt
2024-09-16 16:20:45,935 - INFO - Stage 6: Preparing MLP classifier...
2024-09-16 16:20:46,178 - INFO - Stage 7: Training and evaluating MLP on original bulk data...
2024-09-16 16:20:46,185 - INFO - Training MLP on original bulk data (using SMOTE)...
2024-09-16 16:21:06,073 - INFO - Epoch [100/100], Average Loss: 0.9267
2024-09-16 16:21:06,082 - INFO - Evaluating MLP on original bulk data:
2024-09-16 16:21:06,084 - INFO - 
Sample counts for each class:
2024-09-16 16:21:06,084 - INFO - Stage 1: 23 samples
2024-09-16 16:21:06,084 - INFO - Stage 2: 100 samples
2024-09-16 16:21:06,085 - INFO - Stage 3: 31 samples
2024-09-16 16:21:06,085 - INFO - Stage 4: 3 samples
2024-09-16 16:21:06,085 - INFO - Stage 5: 4 samples
2024-09-16 16:21:06,085 - INFO - Total samples: 161
2024-09-16 16:21:06,087 - INFO - 
F1 scores for each class:
2024-09-16 16:21:06,087 - INFO - Stage 1 F1 score: 0.0476
2024-09-16 16:21:06,087 - INFO - Stage 2 F1 score: 0.6404
2024-09-16 16:21:06,087 - INFO - Stage 3 F1 score: 0.3235
2024-09-16 16:21:06,087 - INFO - Stage 4 F1 score: 0.0000
2024-09-16 16:21:06,088 - INFO - Stage 5 F1 score: 0.0000
2024-09-16 16:21:06,089 - INFO - 
Macro-averaged F1 score: 0.2023
2024-09-16 16:21:06,093 - INFO - Average precision score: 0.2123
2024-09-16 16:21:06,094 - INFO - 
Confusion Matrix:
2024-09-16 16:21:06,095 - INFO - 
[[ 1 17  4  1  0]
 [14 65 20  1  0]
 [ 4 16 11  0  0]
 [ 0  2  1  0  0]
 [ 0  3  1  0  0]]
2024-09-16 16:21:06,101 - INFO - 
Classification Report:
2024-09-16 16:21:06,101 - INFO - 
              precision    recall  f1-score   support

           1       0.05      0.04      0.05        23
           2       0.63      0.65      0.64       100
           3       0.30      0.35      0.32        31
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         4

    accuracy                           0.48       161
   macro avg       0.20      0.21      0.20       161
weighted avg       0.46      0.48      0.47       161

2024-09-16 16:21:06,101 - INFO - Stage 8: Training and evaluating MLP on Barlow Twins embeddings...
2024-09-16 16:21:06,103 - INFO - Training MLP on Barlow Twins embeddings (using SMOTE)...
2024-09-16 16:21:24,648 - INFO - Epoch [100/100], Average Loss: 1.0629
2024-09-16 16:21:24,649 - INFO - Evaluating MLP on Barlow Twins embeddings:
2024-09-16 16:21:24,650 - INFO - 
Sample counts for each class:
2024-09-16 16:21:24,650 - INFO - Stage 1: 23 samples
2024-09-16 16:21:24,650 - INFO - Stage 2: 100 samples
2024-09-16 16:21:24,650 - INFO - Stage 3: 31 samples
2024-09-16 16:21:24,651 - INFO - Stage 4: 3 samples
2024-09-16 16:21:24,651 - INFO - Stage 5: 4 samples
2024-09-16 16:21:24,651 - INFO - Total samples: 161
2024-09-16 16:21:24,653 - INFO - 
F1 scores for each class:
2024-09-16 16:21:24,653 - INFO - Stage 1 F1 score: 0.2466
2024-09-16 16:21:24,653 - INFO - Stage 2 F1 score: 0.4837
2024-09-16 16:21:24,653 - INFO - Stage 3 F1 score: 0.3023
2024-09-16 16:21:24,653 - INFO - Stage 4 F1 score: 0.0000
2024-09-16 16:21:24,654 - INFO - Stage 5 F1 score: 0.0000
2024-09-16 16:21:24,655 - INFO - 
Macro-averaged F1 score: 0.2065
2024-09-16 16:21:24,660 - INFO - Average precision score: 0.2301
2024-09-16 16:21:24,661 - INFO - 
Confusion Matrix:
2024-09-16 16:21:24,662 - INFO - 
[[ 9  8  6  0  0]
 [28 37 33  2  0]
 [11  6 13  0  1]
 [ 1  1  1  0  0]
 [ 1  1  2  0  0]]
2024-09-16 16:21:24,667 - INFO - 
Classification Report:
2024-09-16 16:21:24,667 - INFO - 
              precision    recall  f1-score   support

           1       0.18      0.39      0.25        23
           2       0.70      0.37      0.48       100
           3       0.24      0.42      0.30        31
           4       0.00      0.00      0.00         3
           5       0.00      0.00      0.00         4

    accuracy                           0.37       161
   macro avg       0.22      0.24      0.21       161
weighted avg       0.50      0.37      0.39       161

2024-09-16 16:21:24,667 - INFO - All stages completed.
